image: debian:testing

stages:
  - linting
  - test

pyflakes:
  stage: linting
  script:
  - apt-get -qqy update
  - apt-get -qqy install --no-install-recommends pyflakes3
  - pyflakes3 ./main.py

mypy:
  stage: linting
  script:
  - apt-get -qqy update
  - apt-get -qqy install --no-install-recommends python3-pip
  - pip3 install mypy
  - mypy --ignore-missing-imports main.py

tests:debian:
  stage: test
  script:
  - apt-get -qqy update
  - apt-get -qqy install --no-install-recommends mat2 python3-flask python3-coverage python3-pip python3-setuptools
  - pip3 install wheel
  - pip3 install -r requirements.txt
  - python3-coverage run --branch --include main.py -m unittest discover -s test
  - python3-coverage report -m
